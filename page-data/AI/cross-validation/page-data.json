{"componentChunkName":"component---src-templates-blog-post-js","path":"/AI/cross-validation/","result":{"data":{"site":{"siteMetadata":{"title":"Gunu's AI Log","author":"[Gunu]","siteUrl":"https://gunu441.github.io","comment":{"disqusShortName":"","utterances":"gunu9441/gunu9441.github.io"},"sponsor":{"buyMeACoffeeId":"gunu9441"}}},"markdownRemark":{"id":"ac2c8a96-461c-5c80-a66d-2d5d04beaaf5","excerpt":"ì´ë²ˆ ì‹œê°„ì—ëŠ” cross validationì— ëŒ€í•´ì„œ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤!âœ¨ cross validationì€ í‰ìƒì‹œ ë°ì´í„°ê°€ ë¶€ì¡±í•  ë•Œ ì‚¬ìš©í•œë‹¤ê³ ë§Œ ì•Œê³  ìˆì—ˆëŠ”ë°, ì´ë²ˆì— ì œëŒ€ë¡œ ì•Œì•„ë³´ê³ ì ê³µë¶€í•´ë³´ì•˜ìŠµë‹ˆë‹¤ğŸ˜ What is Cross validationâ€¦","html":"<p>Â  Â  ì´ë²ˆ ì‹œê°„ì—ëŠ” cross validationì— ëŒ€í•´ì„œ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤!âœ¨ cross validationì€ í‰ìƒì‹œ ë°ì´í„°ê°€ ë¶€ì¡±í•  ë•Œ ì‚¬ìš©í•œë‹¤ê³ ë§Œ ì•Œê³  ìˆì—ˆëŠ”ë°, ì´ë²ˆì— ì œëŒ€ë¡œ ì•Œì•„ë³´ê³ ì ê³µë¶€í•´ë³´ì•˜ìŠµë‹ˆë‹¤ğŸ˜</p>\n<h2 id=\"what-is-cross-validation\" style=\"position:relative;\"><a href=\"#what-is-cross-validation\" aria-label=\"what is cross validation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What is Cross validation?</h2>\n<p>Â  Â  ë³´í†µ í° ë°ì´í„° ì…‹ì´ ìˆë‹¤ë©´ ì‹¤ì œ ëª¨ë¸ì„ í‰ê°€í•˜ê¸° ìœ„í•´ì„œ ë°ì´í„°ë¥¼ í›ˆë ¨ìš©, ê²€ì¦ìš©, í…ŒìŠ¤íŠ¸ìš© ì´ë ‡ê²Œ ì„¸ ê°€ì§€ë¡œ ë¶„ë¦¬í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì ì…ë‹ˆë‹¤. í›ˆë ¨ìš© ë°ì´í„°ë¡œëŠ” <strong>ë°ì´í„° í›ˆë ¨</strong>ì„, ê²€ì¦ìš© ë°ì´í„°ë¡œëŠ” <strong>ëª¨ë¸ì˜ ì„±ëŠ¥ì„ ì¡°ì ˆ</strong>í•˜ê²Œ ë©ë‹ˆë‹¤. ëª¨ë¸ì´ <strong>ê³¼ì í•©ì´ ë˜ê³  ìˆëŠ”ì§€ íŒë‹¨</strong>í•˜ê±°ë‚˜ <strong>í›ˆë ¨ìš© ë°ì´í„°ë¡œ í›ˆë ¨ì„ ì‹œí‚¨ ëª¨ë¸ì˜ ì •í™•ë„</strong>ë¥¼ <strong>ê²€ì¦ìš© ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ê²€ì¦</strong>í•˜ë©´ì„œ <strong>í•˜ì´í¼ íŒŒë¼ë¯¸í„°ë¥¼ ì¡°ì •</strong>(<strong>hyper parameter tuning</strong>)ì„ í•˜ê²Œ ë©ë‹ˆë‹¤.</p>\n<p>Â  Â  ì´ëŸ° ê³¼ì •ì´ ëë‚˜ê²Œ ëœë‹¤ë©´ <strong>ê²€ì¦ìš© ë°ì´í„°ì— ëŒ€í•´ì„œ ì¼ì • ë¶€ë¶„ ìµœì í™”ê°€ ì§„í–‰</strong>ë˜ì—ˆê¸° ë•Œë¬¸ì— <strong>ê²€ì¦ìš© ë°ì´í„°ë¡œ ëª¨ë¸ì„ í‰ê°€í•˜ëŠ” ê²ƒì´ ì í•©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤</strong>. ì´ì— <strong>í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ í†µí•´</strong> ëª¨ë¸ì˜ ì§„ì§œ <strong>ì„±ëŠ¥ì„ í‰ê°€</strong>í•˜ê²Œ ë©ë‹ˆë‹¤.</p>\n<p>í‰ìƒì‹œ ëŒ€íšŒì—ì„œëŠ”, test dataì˜ labelì€ ëª¨ë¥´ëŠ” ìƒíƒœì—ì„œ dataì˜ labelì„ ë§ì¶°ì•¼ í•˜ë¯€ë¡œ ì£¼ì–´ì§„ <strong>training datasetì„ training setê³¼ validation setì„ ë‚˜ëˆ ì•¼</strong>í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ <em>training datasetì´ ì‘ì•„ì„œ traning setê³¼ validation setìœ¼ë¡œ ë‚˜ëˆ„ì§€ ëª»í•˜ëŠ” ê²½ìš°</em> <strong>cross validationì„ ì‚¬ìš©</strong>í•©ë‹ˆë‹¤. ì˜¤ëŠ˜ ì•Œì•„ë³¼ cross validationì—ëŠ” <strong>K-Fold cross validation</strong>, <strong>Startified-K-Fold cross validation</strong>ì´ ìˆìŠµë‹ˆë‹¤.</p>\n<h2 id=\"k-fold-cross-validation\" style=\"position:relative;\"><a href=\"#k-fold-cross-validation\" aria-label=\"k fold cross validation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>K-Fold cross validation</h2>\n<p>Â  Â  <strong>K-Fold cross validation</strong>ì€ ì „ì²´ ë°ì´í„° ì…‹ì„ <strong>training setê³¼ test set</strong>ìœ¼ë¡œ ë‚˜ëˆˆ ë’¤, <strong>training setì„ ë‹¤ì‹œ training setê³¼ validation set</strong>ìœ¼ë¡œ ë‚˜ëˆ„ëŠ”ë° ì´ ë•Œ, <strong>kê°œì˜ fold</strong>ë¡œ ë‚˜ëˆ„ê²Œ ë©ë‹ˆë‹¤. <strong>kê°œ ì˜ foldê°€ kë²ˆ ë™ì•ˆ ì°¨ë¡€ëŒ€ë¡œ validation setì´ ë˜ê³  ë‚˜ë¨¸ì§€ foldëŠ” training set</strong>ì´ ë©ë‹ˆë‹¤. ì•„ë˜ì˜ ê·¸ë¦¼ì€ ë°©ê¸ˆí•œ ì„¤ëª…ì„ ë„ì‹í™” í•œ ê²ƒì…ë‹ˆë‹¤.</p>\n<p align=\"center\">\n    &lt; How to implement cross validation? &gt;\n</p>\n<p align=\"center\">\n   <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 70%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACs0lEQVQ4y32T63PaRhTF+f8/pl8y6Uw/N5686qaxMfUjKdgG4+BH/MIGJDAS0kqrBxLoAfy6UuIwmWa6M0f3Snfn3LP3rCqotVqtCIII3w9/QFBiiu+F6NoQXR+ta0HwDeE3BIThlMoToTMNsQNPwccO/TK3fInte2WuWybaxCjroqjLKaar4AQqhmUu/HhN2Ege+JBeUk2vqGZXvJ92+F3/WOKNOKa2uGEnv2Y7+0ItueL1Tcyv7ZRf9sc82x3xoj1n8zZbE+YsS2QsVFyVMV3m37Gufd2XLFbMsiWzdEGc5GWe5CsqBVmBOJoRqlnM52k5u1k8J4pipmHEbJao2rT8VrxP1azyPOdnq/KUjE2Lh/4ARwbc3vcwLIfho0FfH2LaLg+DgYoOA2WM/jjGceV30idRBSpSuqU7e7cRG0ceLeHyUZ7QiXrU5R2fxDWfQ51d+1xFrXxveHfKFJfFT1RWhBD4yvK9UY9X3Q4HY8Fv9S7Ve4sd+zNbRouG7PJ2eEjD7fLhsU3V6mBJhzzLflBXKvR9n2kU0QruqYkTjt0JL8809jWb6nDAX70Hmp5G1W6rPT32xCUH8oqJI3AdB8MwsCwL0zRxXVcptG08z6Opum+PT+nMdbbNw7LBm47DRtOmMRkrZac05YDdyTkH4kt55ELhYrEoUcyziJXihkdKYd2940/jhKOwz7tRi3/UMXfEBVXRZvte8HzfYavrUHXa1NxzLFewUIRfXVkWj8IdKoVcKSUNccOmfkQ71njbq3OoDKlZZ2yNVBPZ449hk7o14uWJycapieVFBcV/TUnTlEx1MhIPbWYzyQIGsYWRegznTolxIrkLdPqe4FwLONN9rP4FmXmJr3UIFJLxBYnore/h/658iSckUjgKE6LiP7/+RNz9G721yeD4HeFNjVhv8y+Q/RGgnQ+vTQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"assets 2021 08 26 1\" title=\"assets 2021 08 26 1\" src=\"/static/20f00d5a70c144f0ed39ca590f25343a/c1b63/1.png\" srcset=\"/static/20f00d5a70c144f0ed39ca590f25343a/5a46d/1.png 300w,\n/static/20f00d5a70c144f0ed39ca590f25343a/0a47e/1.png 600w,\n/static/20f00d5a70c144f0ed39ca590f25343a/c1b63/1.png 1200w,\n/static/20f00d5a70c144f0ed39ca590f25343a/d61c2/1.png 1800w,\n/static/20f00d5a70c144f0ed39ca590f25343a/565cc/1.png 1806w\" sizes=\"(max-width: 1200px) 100vw, 1200px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n</p>\n<p>Â  Â  í•´ë‹¹ ê·¸ë¦¼ì„ ë³´ê²Œë˜ë©´ <strong>ALL Data(ëª¨ë“  ë°ì´í„°)ë¥¼ Training dataì™€ Test data</strong>ë¡œ ë‚˜ëˆˆ ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´í›„ <strong>5-Fold cross validationì„ ì‚¬ìš©</strong>í–ˆëŠ”ë° <strong>5-Fold ì´ê¸° ë•Œë¬¸ì— 5ë²ˆ ë™ì•ˆ 5ê°œì˜ Foldê°€ í•œë²ˆì”© validation setì´ ë˜ë©° ì§„í–‰</strong>ë©ë‹ˆë‹¤(ë‚˜ë¨¸ì§€ <strong>4ê°œì˜ foldëŠ” í•™ìŠµë°ì´í„°</strong>ê°€ ë©ë‹ˆë‹¤.). ì´ë ‡ê²Œ í•™ìŠµí•˜ë©´ì„œ ê²€ì¦ì„ í•˜ê²Œ ë˜ë©° í•™ìŠµì´ ëë‚œ ì´í›„ì— <strong>Test dataë¥¼ í†µí•´ ë§ˆì§€ë§‰ evaluation</strong>ì„ ê±°ì¹˜ê²Œ ë©ë‹ˆë‹¤.</p>\n<h2 id=\"code\" style=\"position:relative;\"><a href=\"#code\" aria-label=\"code permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Code</h2>\n<p>Â  Â  <strong>ì‚¬ì´í‚·ëŸ°ì„ ì‚¬ìš©</strong>í•˜ë©´ <strong>K-Fold cross validationì„ ì†ì‰½ê²Œ êµ¬í˜„</strong>í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ì˜ ì½”ë“œì™€ ê°™ì´ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>model_selection <span class=\"token keyword\">import</span> KFold\n\nX<span class=\"token operator\">=</span>np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">[</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span><span class=\"token number\">22</span><span class=\"token punctuation\">,</span><span class=\"token number\">23</span><span class=\"token punctuation\">,</span><span class=\"token number\">24</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">31</span><span class=\"token punctuation\">,</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span><span class=\"token number\">33</span><span class=\"token punctuation\">,</span><span class=\"token number\">34</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">41</span><span class=\"token punctuation\">,</span><span class=\"token number\">42</span><span class=\"token punctuation\">,</span><span class=\"token number\">43</span><span class=\"token punctuation\">,</span><span class=\"token number\">44</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">51</span><span class=\"token punctuation\">,</span><span class=\"token number\">52</span><span class=\"token punctuation\">,</span><span class=\"token number\">53</span><span class=\"token punctuation\">,</span><span class=\"token number\">54</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">61</span><span class=\"token punctuation\">,</span><span class=\"token number\">62</span><span class=\"token punctuation\">,</span><span class=\"token number\">63</span><span class=\"token punctuation\">,</span><span class=\"token number\">64</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">71</span><span class=\"token punctuation\">,</span><span class=\"token number\">72</span><span class=\"token punctuation\">,</span><span class=\"token number\">73</span><span class=\"token punctuation\">,</span><span class=\"token number\">74</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\ny<span class=\"token operator\">=</span>np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\nsplits <span class=\"token operator\">=</span> KFold<span class=\"token punctuation\">(</span>n_splits<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> random_state<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> shuffle<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">for</span> fold<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>train_idx<span class=\"token punctuation\">,</span>val_idx<span class=\"token punctuation\">)</span> <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>splits<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\tX_train<span class=\"token punctuation\">,</span> X_validate <span class=\"token operator\">=</span> X<span class=\"token punctuation\">[</span>train_idx<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> X<span class=\"token punctuation\">[</span>val_idx<span class=\"token punctuation\">]</span>\n  y_train<span class=\"token punctuation\">,</span> y_validate <span class=\"token operator\">=</span> y<span class=\"token punctuation\">[</span>train_idx<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">[</span>val_idx<span class=\"token punctuation\">]</span></code></pre></div>\n<p>Â  Â  <code class=\"language-text\">X</code>ë¼ëŠ” ë…ë¦½ ë³€ìˆ˜ì´ë©°, <code class=\"language-text\">y</code>ëŠ” ì¢…ì†ë³€ìˆ˜ ì…ë‹ˆë‹¤. <code class=\"language-text\">X</code>ì™€ <code class=\"language-text\">y</code>ë¥¼ <code class=\"language-text\">n_splits</code>ê°œì˜ foldë¡œ ë‚˜ëˆ„ì–´ <code class=\"language-text\">n_splits</code>ë²ˆ ë§Œí¼ trainingê³¼ validationì´ ì§„í–‰ ë©ë‹ˆë‹¤. ê·¸ë¦¼ê³¼ ê°™ì€ ë°©ë²•ìœ¼ë¡œ K-Foldë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>Â  Â  K-Fold cross validationì˜ ê¸°ë³¸ ì½”ë“œì„ ì‚´í´ë³´ì•˜ìœ¼ë‹ˆ K-Fold cross validationì„ ì‹¤ì œë¡œ pytorchì—ì„œ ì–´ë–¤ êµ¬ì¡°ë¡œ êµ¬í˜„ë˜ëŠ”ì§€ ì‚´í´ ë³´ê² ìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># k-fold</span>\n<span class=\"token keyword\">for</span> fold<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>train_ids<span class=\"token punctuation\">,</span> test_ids<span class=\"token punctuation\">)</span> <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>kfold<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span>dataset<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n<span class=\"token comment\"># epoch</span>\n\t<span class=\"token keyword\">for</span> epoch <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> num_epochs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n<span class=\"token comment\"># trainloader</span>\n\t\t<span class=\"token keyword\">for</span> i<span class=\"token punctuation\">,</span> data <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>trainloader<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></code></pre></div>\n<p>Â  Â  <code class=\"language-text\">kfold</code>ë¥¼ ë¨¼ì € ì‚¬ìš©í•˜ì—¬ ì²« forë¬¸ì„ ëŒë¦° ì´í›„, í•´ë‹¹ <code class=\"language-text\">kfold</code>ë¥¼ í†µí•´ ì •í•´ì§„ training datasetì„ í†µí•´ epochë¥¼ ëŒë¦½ë‹ˆë‹¤. ë˜í•œ, dataloaderë¥¼ ì‚¬ìš©í•˜ì—¬ ì •í•´ì§„ batch-sizeëŒ€ë¡œ dataë¥¼ ë°›ì•„ì™€ì„œ ì •í•´ì§„ epoch ë§Œí¼ kë²ˆ ëŒì•„ê°€ê²Œ ë©ë‹ˆë‹¤. 1ê°œì˜ fold ë‹¹ <code class=\"language-text\">num_epochs</code>ë§Œí¼ ëŒê¸° ë•Œë¬¸ì— ì „ì²´ epochëŠ” <code class=\"language-text\">num_epochs</code>* <code class=\"language-text\">fold</code>ê°€ ë©ë‹ˆë‹¤.</p>\n<p>Â  Â  ì•„ë˜ëŠ” classification taskì— cross validationì„ ì ìš©í•œ codeì…ë‹ˆë‹¤.</p>\n<p>link: <a href=\"https://github.com/gunu9441/AI/blob/main/7.CNN/Deep_CNN_MNIST_using_cross_validation.ipynb\">https://github.com/gunu9441/AI/blob/main/7.CNN/Deep<em>CNN</em>MNIST<em>using</em>cross_validation.ipynb</a></p>\n<p>ë‹¤ìŒì€ <code class=\"language-text\">SubsetRandomSampler</code>ë¥¼ ì´í•´í•˜ê³ ì pytorch documentationì— ìˆëŠ” sourceë¥¼ ê°€ì ¸ì˜¨ ê²ƒì…ë‹ˆë‹¤. ì•„ë˜ì˜ ì½”ë“œì— ëŒ€í•´ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">[</span>docs<span class=\"token punctuation\">]</span><span class=\"token keyword\">class</span> <span class=\"token class-name\">SubsetRandomSampler</span><span class=\"token punctuation\">(</span>Sampler<span class=\"token punctuation\">[</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">r\"\"\"Samples elements randomly from a given list of indices, without replacement.\n\n    Args:\n        indices (sequence): a sequence of indices\n        generator (Generator): Generator used in sampling.\n    \"\"\"</span>\n    indices<span class=\"token punctuation\">:</span> Sequence<span class=\"token punctuation\">[</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">]</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> indices<span class=\"token punctuation\">:</span> Sequence<span class=\"token punctuation\">[</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> generator<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>indices <span class=\"token operator\">=</span> indices\n        self<span class=\"token punctuation\">.</span>generator <span class=\"token operator\">=</span> generator\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__iter__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> Iterator<span class=\"token punctuation\">[</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>indices<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> torch<span class=\"token punctuation\">.</span>randperm<span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>indices<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> generator<span class=\"token operator\">=</span>self<span class=\"token punctuation\">.</span>generator<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__len__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>indices<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Â  Â  <code class=\"language-text\">indices</code> parameterì— a set of <code class=\"language-text\">index</code>ê°€ ë“¤ì–´ ê°€ë¯€ë¡œ <code class=\"language-text\">__iter__</code>ì— <code class=\"language-text\">len(self.indices)</code>ì— a set of <code class=\"language-text\">index</code>ì˜ ê°¯ìˆ˜ê°€ ë“¤ì–´ê°€ê²Œ ë©ë‹ˆë‹¤. ì´í›„, <code class=\"language-text\">torch.randperm()</code>ì˜ parameterë¡œ ë“¤ì–´ê°€ê²Œ ë˜ì–´ <code class=\"language-text\">len(indices)</code> í¬ê¸°ì˜ ë°°ì—´ì— <code class=\"language-text\">len(indices)</code>ë¯¸ë§Œì˜ ìˆ«ìë“¤ì´ ì¤‘ë³µ ì—†ì´ ì •ë ¬ë˜ê²Œ ë©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ 0ë²ˆì§¸ indexë¶€í„° <code class=\"language-text\">len(indices)-1</code>ê¹Œì§€ ì°¨ë¡€ëŒ€ë¡œ forë¬¸ì„ í†µí•´ ê°€ì ¸ì™€ì„œ indicesì•ˆì— ìˆëŠ” ê°’ë“¤ì„ ë½‘ì•„ì„œ returní•˜ê²Œ ë©ë‹ˆë‹¤. ì¦‰, randomí•˜ê²Œ a set of <code class=\"language-text\">index</code>ì•ˆì— ìˆëŠ” <code class=\"language-text\">index</code>ë“¤ì„ ë½‘ì•„ë‚´ê¸° ìœ„í•´ <code class=\"language-text\">SubsetRandomSampler</code>ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ <code class=\"language-text\">SubsetRandomSampler</code> ë•ë¶„ì— <code class=\"language-text\">torch.utils.data.Dataloader</code>ë¥¼ ì‚¬ìš©í•  ë•Œ <code class=\"language-text\">shuffle = True</code><strong>ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„</strong> ë©ë‹ˆë‹¤.</p>\n<h2 id=\"startified-k-fold-cross-validation\" style=\"position:relative;\"><a href=\"#startified-k-fold-cross-validation\" aria-label=\"startified k fold cross validation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Startified-K-Fold cross validation</h2>\n<p>Â  Â  <strong>Startified-K-Fold cross validation</strong>ì€ <strong>í•˜ë‚˜ì˜ foldì•ˆ</strong>ìœ¼ë¡œ ë“¤ì–´ê°ˆ <strong>labelë“¤ì˜ ì¢…ë¥˜ê°€ ê³¨ê³ ë£¨</strong> ë“¤ì–´ê°ˆ ìˆ˜ ìˆë„ë¡ ì¡°ì •í•´ì£¼ëŠ” ì—­í• ê¹Œì§€ ìˆ˜í–‰í•©ë‹ˆë‹¤. <code class=\"language-text\">StartifiedKFold</code>ì˜ ì‚¬ìš©ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>model_selection <span class=\"token keyword\">import</span> StratifiedKFold\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>model_selection <span class=\"token keyword\">import</span> KFold\n\nX<span class=\"token operator\">=</span>np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">[</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span><span class=\"token number\">22</span><span class=\"token punctuation\">,</span><span class=\"token number\">23</span><span class=\"token punctuation\">,</span><span class=\"token number\">24</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">31</span><span class=\"token punctuation\">,</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span><span class=\"token number\">33</span><span class=\"token punctuation\">,</span><span class=\"token number\">34</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">41</span><span class=\"token punctuation\">,</span><span class=\"token number\">42</span><span class=\"token punctuation\">,</span><span class=\"token number\">43</span><span class=\"token punctuation\">,</span><span class=\"token number\">44</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">51</span><span class=\"token punctuation\">,</span><span class=\"token number\">52</span><span class=\"token punctuation\">,</span><span class=\"token number\">53</span><span class=\"token punctuation\">,</span><span class=\"token number\">54</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">61</span><span class=\"token punctuation\">,</span><span class=\"token number\">62</span><span class=\"token punctuation\">,</span><span class=\"token number\">63</span><span class=\"token punctuation\">,</span><span class=\"token number\">64</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">71</span><span class=\"token punctuation\">,</span><span class=\"token number\">72</span><span class=\"token punctuation\">,</span><span class=\"token number\">73</span><span class=\"token punctuation\">,</span><span class=\"token number\">74</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\ny<span class=\"token operator\">=</span>np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\nstratifiedkfold <span class=\"token operator\">=</span> StratifiedKFold<span class=\"token punctuation\">(</span>n_splits<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>random_state<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>shuffle<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\nStratifiedKFold**************\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> train_index<span class=\"token punctuation\">,</span> validate_index <span class=\"token keyword\">in</span> stratifiedkfold<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"train index:\"</span><span class=\"token punctuation\">,</span> train_index<span class=\"token punctuation\">,</span> <span class=\"token string\">\"validate index:\"</span><span class=\"token punctuation\">,</span> validate_index<span class=\"token punctuation\">)</span>\n    X_train<span class=\"token punctuation\">,</span> X_validate <span class=\"token operator\">=</span> X<span class=\"token punctuation\">[</span>train_index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> X<span class=\"token punctuation\">[</span>validate_index<span class=\"token punctuation\">]</span>\n    y_train<span class=\"token punctuation\">,</span> y_validate <span class=\"token operator\">=</span> y<span class=\"token punctuation\">[</span>train_index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">[</span>validate_index<span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"train data\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>X_train<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"validate data\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>X_validate<span class=\"token punctuation\">,</span> y_validate<span class=\"token punctuation\">)</span></code></pre></div>\n<p>ë‹¤ìŒì˜ ì½”ë“œì˜ ê²°ê³¼ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p>\n<p align=\"center\">\n    &lt; Result &gt;\n</p>\n<p align=\"center\">\n   <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 356px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 106.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsTAAALEwEAmpwYAAABo0lEQVQ4y53UV47DMAwEUF8qvffe738WBk8AF0ayQJx8CJRtacQpcrVcLmOxWMR8Po/1eh3j8Tja7XZ0Op230e12P45qNBrFcDgsYzAYxHQ6LfW/xQnswDz0tVbb7TYul0vp8nq9xv1+j9PpFMfjsdTD4VA6N9/v93+HYqKJyWRS6mw2i16vFxUgi1EGlh1aYNhgWLfb7cp3B6xWq8DOPtVzv9+ParPZxPl8Dp1mtbnVar1Ry3dZ61S9K5RtRhkdnT4ej0I9F3xjSDEFhdvtVrRKDVUf0yyU6NMEuCIuMPqgb254T5+ME10bAdIM3bqbslnXKOcZnY+UAWQFqttvdHujrCsguuS0DOqqHuamo5KxjAsgc8bQjqYqSdIYQ95e52rpEE2xsVFkBDTvtgpUzZwKOzaesVPtSeNKsHXgpQ201E393n5F2YnAsiMn0rKJKa+hL4BpSgLp0nOa8pPLQNJlYDTVOV2Y5rDGwUYXSDrtGqLuI/fUdLARIFN0pEOxcY+B1ynXtfp4U1ADgi5g0QGYf5ufrh6gNMRcsEUH9cxiUw2fCiXU4c8p0UEAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"assets 2021 08 26 2\" title=\"assets 2021 08 26 2\" src=\"/static/0e09c364afa8bd199f1ab4c615463eb5/50ac3/2.png\" srcset=\"/static/0e09c364afa8bd199f1ab4c615463eb5/5a46d/2.png 300w,\n/static/0e09c364afa8bd199f1ab4c615463eb5/50ac3/2.png 356w\" sizes=\"(max-width: 356px) 100vw, 356px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n</p>\n<p>Â  Â  ìœ„ì˜ ê²°ê³¼ë¥¼ ë³´ê²Œë˜ë©´ label ê°’ì´ ê³¨ê³ ë£¨ ë“¤ì–´ê°ˆ ìˆ˜ ìˆë„ë¡ ë¶„ë°° ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<h2 id=\"summary\" style=\"position:relative;\"><a href=\"#summary\" aria-label=\"summary permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Summary</h2>\n<ul>\n<li><code class=\"language-text\">torch.utils.data.Dataloader</code>ë¥¼ ì‚¬ìš©í•´ë„ ëª¨ë“  ë°ì´í„°ë¥¼ batch<em>sizeë¡œ ë‚˜ëˆ ì„œ mini</em>batchë¡œ ë§Œë“¤ì–´ ì‚¬ìš©í•˜ë¯€ë¡œ <strong>í•œ epochì•ˆì—ì„œ ë°˜ë“œì‹œ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚¬ìš©</strong>í•˜ê²Œ ë©ë‹ˆë‹¤.</li>\n<li><strong>k-Fold cross validation</strong>ì€ <strong>kë²ˆ ë™í•œ forë¬¸</strong>ì„ ëŒë©° <strong>datasetì„ k foldê°œ ë§Œí¼ ë‚˜ëˆ„ê²Œ</strong> ë©ë‹ˆë‹¤. ë˜í•œ, <strong>k-1ê°œì˜ foldë¥¼ ì‚¬ìš©í•˜ì—¬ training set</strong>ë¥¼ ë§Œë“¤ê³  <strong>1ê°œì˜ foldë¥¼ ì‚¬ìš©í•˜ì—¬ validation set</strong>ì„ ë§Œë“­ë‹ˆë‹¤. <strong>ì´ ê³¼ì •ì„ kë²ˆ ë™ì•ˆ ë°˜ë³µ</strong>í•˜ë©° í•™ìŠµê³¼ ê²€ì¦ì„ kë²ˆ ì§„í–‰í•©ë‹ˆë‹¤.</li>\n<li><code class=\"language-text\">SubsetRandomSampler</code>ë¥¼ ì‚¬ìš©í•˜ë©´ <code class=\"language-text\">torch.utils.data.Dataloader</code>ì˜ <code class=\"language-text\">shuffle=True</code>ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤.</li>\n<li><code class=\"language-text\">shuffle = True</code>ë¥¼ ì‚¬ìš©í•´ì„œ <code class=\"language-text\">KFold</code>ë¥¼ ì‚¬ìš©í•  ê²½ìš°, k-Foldë¡œ <strong>splití•˜ê¸° ì „ì— ë¨¼ì € ì „ì²´ ë°ì´í„°ë¥¼ í•œ ë²ˆ(!) shuffleì„ ìˆ˜í–‰</strong>í•©ë‹ˆë‹¤. <code class=\"language-text\">random_state</code>ëŠ” <code class=\"language-text\">random seedì™€ ê°™ì€ ê°œë…</code>ì…ë‹ˆë‹¤.</li>\n</ul>\n<p>ì´ê²ƒìœ¼ë¡œ ì´ë²ˆ í¬ìŠ¤íŠ¸ë¥¼ ë§ˆë¬´ë¦¬í•˜ê² ìŠµë‹ˆë‹¤.</p>\n<p>ê°ì‚¬í•©ë‹ˆë‹¤ğŸ˜‰ğŸ‘</p>\n<h2 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h2>\n<hr>\n<ul>\n<li>The description of <code class=\"language-text\">train_test_split</code> and <code class=\"language-text\">KFold()</code>: <a href=\"https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&#x26;blogId=gustn3964&#x26;logNo=221431914515\">https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&#x26;blogId=gustn3964&#x26;logNo=221431914515</a></li>\n<li>The code of <code class=\"language-text\">StartifiedKFold</code> and <code class=\"language-text\">KFold</code> <a href=\"https://swlock.blogspot.com/2019/01/scikit-learn-cross-validation-iterators.html?m=1\">https://swlock.blogspot.com/2019/01/scikit-learn-cross-validation-iterators.html?m=1</a></li>\n<li>Cross validation(Keras): <a href=\"https://m.blog.naver.com/nywoo19/221970913783\">https://m.blog.naver.com/nywoo19/221970913783</a></li>\n<li>Python yield: <a href=\"https://dojang.io/mod/page/view.php?id=2412\">https://dojang.io/mod/page/view.php?id=2412</a></li>\n<li>Cross validation sample github: <a href=\"https://github.com/gucci-j/pytorch-imdb-cv/blob/master/src/load_data.py\">https://github.com/gucci-j/pytorch-imdb-cv/blob/master/src/load_data.py</a></li>\n<li>Pytorch cross validation: <a href=\"https://www.machinecurve.com/index.php/2021/02/03/how-to-use-k-fold-cross-validation-with-pytorch/\">https://www.machinecurve.com/index.php/2021/02/03/how-to-use-k-fold-cross-validation-with-pytorch/</a></li>\n<li>Basic concept of dataset: <a href=\"https://wikidocs.net/60021\">https://wikidocs.net/60021</a></li>\n<li>Pytorch K-fold: <a href=\"https://medium.com/dataseries/k-fold-cross-validation-with-pytorch-and-sklearn-d094aa00105f\">https://medium.com/dataseries/k-fold-cross-validation-with-pytorch-and-sklearn-d094aa00105f</a></li>\n<li>randperm: <a href=\"https://bigdatadiary0819.tistory.com/60\">https://bigdatadiary0819.tistory.com/60</a></li>\n<li>KFold <code class=\"language-text\">shuffle=True</code>: <a href=\"https://stackoverflow.com/questions/12237127/how-to-use-shuffle-in-kfold-in-scikit-learn\">https://stackoverflow.com/questions/12237127/how-to-use-shuffle-in-kfold-in-scikit-learn</a></li>\n</ul>","frontmatter":{"title":"Cross Validation","date":"August 26, 2021"}}},"pageContext":{"slug":"/AI/cross-validation/","previous":{"fields":{"slug":"/AI/batch-normalization/"},"frontmatter":{"title":"Batch Normalization"}},"next":null}},"staticQueryHashes":["2486386679","3128451518"]}